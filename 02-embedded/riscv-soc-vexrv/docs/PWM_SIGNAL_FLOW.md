# PWM Signal Flow Diagram

This document explains how PWM signals flow from the hardware generator to physical FPGA pins and ultimately to the H-bridge gate drivers.

---

## ğŸ”„ Signal Flow Overview

```
RISC-V CPU â†’ Wishbone Bus â†’ PWM Accelerator â†’ 8 PWM Channels â†’ FPGA Pins â†’ Gate Drivers â†’ H-Bridge Switches
```

---

## ğŸ“Š Detailed Signal Flow

### 1. CPU Control (Firmware)

**Firmware writes PWM configuration:**
```
Base Address: 0x00020000

Register Writes:
  [0x04] FREQ_DIV  = 5000    â†’ 5 kHz carrier
  [0x08] MOD_INDEX = 16384   â†’ 50% modulation
  [0x10] SINE_FREQ = 100     â†’ 76 kHz sine
  [0x14] DEADTIME  = 50      â†’ 1 Î¼s dead-time
  [0x00] CTRL      = 1       â†’ Enable, Auto Sine mode
```

### 2. PWM Accelerator Internal Processing

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PWM ACCELERATOR                          â”‚
â”‚                  (rtl/peripherals/pwm_accelerator.v)        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ Carrier Generatorâ”‚         â”‚  Sine Generator  â”‚         â”‚
â”‚  â”‚  (carrier_gen)   â”‚         â”‚   (sine_gen)     â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚           â”‚                            â”‚                   â”‚
â”‚           â”‚ carrier1: -32768 to -1     â”‚ sine_ref          â”‚
â”‚           â”‚ carrier2: 0 to +32767      â”‚ -32768 to +32767  â”‚
â”‚           â”‚                            â”‚                   â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                        â–¼                                   â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚         â”‚    4Ã— PWM Comparators        â”‚                   â”‚
â”‚         â”‚  (pwm_comp1..pwm_comp4)      â”‚                   â”‚
â”‚         â”‚  with Dead-time Insertion    â”‚                   â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                        â”‚                                   â”‚
â”‚                        â–¼                                   â”‚
â”‚              pwm_out[7:0] (8 channels)                     â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. PWM Comparator Details

**Each comparator generates complementary pair with dead-time:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       PWM Comparator Instance           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  Inputs:                                â”‚
â”‚    - reference (sine_ref)               â”‚
â”‚    - carrier (carrier1 or carrier2)     â”‚
â”‚    - deadtime (50 cycles)               â”‚
â”‚                                         â”‚
â”‚  Logic:                                 â”‚
â”‚    raw_pwm = (reference > carrier)      â”‚
â”‚                                         â”‚
â”‚    pwm_high = raw_pwm & !dead_time      â”‚
â”‚    pwm_low  = !raw_pwm & !dead_time     â”‚
â”‚                                         â”‚
â”‚  Outputs:                               â”‚
â”‚    - pwm_high (high-side switch)        â”‚
â”‚    - pwm_low  (low-side switch)         â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4. Channel Assignment

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   PWM Channel Mapping                          â”‚
â”œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚Bit â”‚Signalâ”‚Switch  â”‚H-Bridge  â”‚ Leg  â”‚ Side â”‚ Carrier Used    â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0  â”‚ S1   â”‚High    â”‚    1     â”‚  1   â”‚ High â”‚ carrier1        â”‚
â”‚ 1  â”‚ S1'  â”‚Low     â”‚    1     â”‚  1   â”‚ Low  â”‚ carrier1        â”‚
â”‚ 2  â”‚ S3   â”‚High    â”‚    1     â”‚  2   â”‚ High â”‚ carrier1        â”‚
â”‚ 3  â”‚ S3'  â”‚Low     â”‚    1     â”‚  2   â”‚ Low  â”‚ carrier1        â”‚
â”‚ 4  â”‚ S5   â”‚High    â”‚    2     â”‚  1   â”‚ High â”‚ carrier2        â”‚
â”‚ 5  â”‚ S5'  â”‚Low     â”‚    2     â”‚  1   â”‚ Low  â”‚ carrier2        â”‚
â”‚ 6  â”‚ S7   â”‚High    â”‚    2     â”‚  2   â”‚ High â”‚ carrier2        â”‚
â”‚ 7  â”‚ S7'  â”‚Low     â”‚    2     â”‚  2   â”‚ Low  â”‚ carrier2        â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5. SOC Top-Level Connection

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        soc_top.v                        â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  pwm_peripheral (PWM Accelerator) â”‚  â”‚
â”‚  â”‚                                   â”‚  â”‚
â”‚  â”‚  .pwm_out[7:0] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”¼â”€â”€â†’ pwm_out[7:0]
â”‚  â”‚                                   â”‚  â”‚     (top-level output)
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6. FPGA Pin Assignment (constraints/basys3.xdc)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Basys 3 Pin Mapping                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Signal   â”‚  Bit    â”‚ Pmod Pin   â”‚ FPGA Pin  â”‚ Gate Driver â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ pwm_out[0] (S1 )  â”‚  JA1       â”‚   J1      â”‚  Driver 1+  â”‚
â”‚ pwm_out[1] (S1') â”‚  JA2       â”‚   L2      â”‚  Driver 1-  â”‚
â”‚ pwm_out[2] (S3 )  â”‚  JA3       â”‚   J2      â”‚  Driver 2+  â”‚
â”‚ pwm_out[3] (S3') â”‚  JA4       â”‚   G2      â”‚  Driver 2-  â”‚
â”‚ pwm_out[4] (S5 )  â”‚  JB1       â”‚   A14     â”‚  Driver 3+  â”‚
â”‚ pwm_out[5] (S5') â”‚  JB2       â”‚   A16     â”‚  Driver 3-  â”‚
â”‚ pwm_out[6] (S7 )  â”‚  JB3       â”‚   B15     â”‚  Driver 4+  â”‚
â”‚ pwm_out[7] (S7') â”‚  JB4       â”‚   B16     â”‚  Driver 4-  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”Œ Physical Connection Diagram

```
Basys 3 FPGA                 Pmod Connectors              Gate Drivers              H-Bridge Modules
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             â”‚              â”‚  Pmod JA â”‚               â”‚          â”‚              â”‚  H-Bridge 1  â”‚
â”‚  pwm_out[0] â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   JA1    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ Driver 1+â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚    Leg 1     â”‚
â”‚  (Pin J1)   â”‚              â”‚          â”‚               â”‚          â”‚              â”‚    S1 (High) â”‚
â”‚             â”‚              â”‚          â”‚               â”‚          â”‚              â”‚              â”‚
â”‚  pwm_out[1] â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   JA2    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ Driver 1-â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚    S1' (Low) â”‚
â”‚  (Pin L2)   â”‚              â”‚          â”‚               â”‚          â”‚              â”‚              â”‚
â”‚             â”‚              â”‚          â”‚               â”‚          â”‚              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  pwm_out[2] â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   JA3    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ Driver 2+â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚    Leg 2     â”‚
â”‚  (Pin J2)   â”‚              â”‚          â”‚               â”‚          â”‚              â”‚    S3 (High) â”‚
â”‚             â”‚              â”‚          â”‚               â”‚          â”‚              â”‚              â”‚
â”‚  pwm_out[3] â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   JA4    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ Driver 2-â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚    S3' (Low) â”‚
â”‚  (Pin G2)   â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚             â”‚
â”‚             â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             â”‚              â”‚  Pmod JB â”‚               â”‚          â”‚              â”‚  H-Bridge 2  â”‚
â”‚  pwm_out[4] â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   JB1    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ Driver 3+â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚    Leg 1     â”‚
â”‚  (Pin A14)  â”‚              â”‚          â”‚               â”‚          â”‚              â”‚    S5 (High) â”‚
â”‚             â”‚              â”‚          â”‚               â”‚          â”‚              â”‚              â”‚
â”‚  pwm_out[5] â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   JB2    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ Driver 3-â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚    S5' (Low) â”‚
â”‚  (Pin A16)  â”‚              â”‚          â”‚               â”‚          â”‚              â”‚              â”‚
â”‚             â”‚              â”‚          â”‚               â”‚          â”‚              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  pwm_out[6] â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   JB3    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ Driver 4+â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚    Leg 2     â”‚
â”‚  (Pin B15)  â”‚              â”‚          â”‚               â”‚          â”‚              â”‚    S7 (High) â”‚
â”‚             â”‚              â”‚          â”‚               â”‚          â”‚              â”‚              â”‚
â”‚  pwm_out[7] â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   JB4    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ Driver 4-â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚    S7' (Low) â”‚
â”‚  (Pin B16)  â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âš¡ Signal Characteristics

### Timing Waveforms

```
Time (Î¼s)      0        50       100      150      200
               â”‚        â”‚        â”‚        â”‚        â”‚
carrier1    â”€â”€â”€â”˜â–”â–”â–”â–”â–”â–”â–”â–”â–”â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–”â–”â–”â–”â–”â–”â–”â–”â–”â”€â”€â”€
               -32768   -1  -32768  -1  -32768   -1

carrier2    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–”â–”â–”â–”â–”â–”â–”â–”â–”â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–”â–”â–”â–”â–”â–”â–”â–”â–”â”€
                     0    32767  0    32767  0   32767

sine_ref    â”€â”€â”€â–â–â–â–â–â–â–â–â–â–â–â–”â–”â–”â–”â–”â–”â–”â–”â–”â–â–â–â–â–â–â–â–â–â–â–â–”â–”â–”â–”â–”â–”â–”â–”â–”â”€â”€â”€
               (76 kHz sinusoidal modulation)

S1 (bit 0)  â–”â–”â–”â–”â–â–â–â–â–â–â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–â–â–â–â–â–â–”â–”â–”â–”â–”â–”â–”â–”â–”â–”â–â–â–â–â–â–â–”â–”â–”
               (PWM switching with varying duty cycle)

S1' (bit 1) â–â–â–â–â–”â–”â–”â–”â–”â–”â–â–â–â–â–â–â–â–â–â–â–”â–”â–”â–”â–”â–”â–â–â–â–â–â–â–â–â–â–â–”â–”â–”â–”â–”â–”â–â–â–
               (Complementary to S1, with dead-time)
                  â†‘
                  â””â”€â”€â”€ Dead-time gap (1 Î¼s)
```

### Level-Shifted Carriers Explained

**Why two carriers?**

For 5-level cascaded H-bridge inverters, we need phase-shifted PWM signals:
- **H-Bridge 1:** Uses carrier1 (-32768 to -1)
- **H-Bridge 2:** Uses carrier2 (0 to +32767)

This creates a **180Â° phase shift** between bridge modules, resulting in 5 distinct output voltage levels when combined.

```
Output Levels:
  +2V  = Both bridges positive
  +1V  = One bridge positive, one zero
   0V  = Both bridges zero
  -1V  = One bridge negative, one zero
  -2V  = Both bridges negative
```

---

## ğŸ”§ Dead-Time Mechanism

Dead-time prevents **shoot-through** (both switches in one leg conducting simultaneously).

```
Without Dead-Time (DANGEROUS!):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
S1  (High) â–”â–”â–”â–”â–”â–”â–â–â–â–â–â–â–”â–”â–”â–”â–”â–”    â† Switches instantly
S1' (Low)  â–â–â–â–â–â–â–”â–”â–”â–”â–”â–”â–â–â–â–â–â–    â† OVERLAP! Short circuit!
              â†‘â†‘ â† Both ON at same time!


With Dead-Time (SAFE):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
S1  (High) â–”â–”â–”â–”â–”â–â–â–â–â–â–â–â–â–”â–”â–”â–”â–”â–”   â† Turns OFF early
S1' (Low)  â–â–â–â–â–â–â–â–â–â–”â–”â–”â–”â–â–â–â–â–â–   â† Turns ON late
              â””â”€â”€â”˜ â† Dead-time gap (50 cycles = 1 Î¼s)
```

---

## ğŸ“ˆ Signal Verification

### Verilog Simulation Results

```
Channel Transitions in 100,000 clock cycles (2 ms @ 50 MHz):

CH0 (S1 ): 164 transitions  âœ“ Switching
CH1 (S1'): 158 transitions  âœ“ Complementary
CH2 (S3 ): 164 transitions  âœ“ Switching
CH3 (S3'): 158 transitions  âœ“ Complementary
CH4 (S5 ): 160 transitions  âœ“ Switching
CH5 (S5'): 161 transitions  âœ“ Complementary
CH6 (S7 ): 160 transitions  âœ“ Switching
CH7 (S7'): 161 transitions  âœ“ Complementary

PWM State Changes: 0x05 â†’ 0xa5 â†’ 0xa0 â†’ 0x05 â†’ ...
   Binary breakdown:
   0x05 = 00000101  (S1=1, S3=1, others=0)
   0xa5 = 10100101  (S1=1, S3=1, S5'=1, S7=1)
   0xa0 = 10100000  (S5'=1, S7=1, others=0)
```

### Expected Oscilloscope Measurements

When connected to actual hardware, you should observe:

**Carrier Frequency:**
- Period: 200 Î¼s
- Frequency: 5 kHz

**PWM Switching:**
- Varying duty cycle following sine modulation
- Dead-time: ~1 Î¼s visible between complementary transitions

**Complementary Pairs:**
- S1 and S1' never both high
- Dead-time gap visible at transitions

---

## ğŸ¯ Summary

**Signal Path:**
1. CPU writes configuration â†’ Wishbone registers
2. Carrier generator â†’ Creates 5 kHz triangle wave
3. Sine generator â†’ Creates 76 kHz modulation reference
4. PWM comparators â†’ Generate 8 PWM channels with dead-time
5. FPGA pins (Pmod JA/JB) â†’ Output 3.3V LVCMOS signals
6. Gate drivers â†’ Isolate and amplify to gate voltage
7. H-bridge switches â†’ Switch power to load

**Key Features:**
- âœ… 8 complementary channels with hardware dead-time
- âœ… Level-shifted carriers for 5-level output
- âœ… Hardware sine generation (no CPU intervention)
- âœ… Configurable via Wishbone registers
- âœ… Verified in Verilog simulation

**All signals are continuously cycling and ready for hardware deployment!**
