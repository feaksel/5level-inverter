// RISC-V 5-Level Inverter Control Firmware - FIXED WATCHDOG ISSUE
// Entry: Initialize stack at top of RAM
00010137
fff10113
// UART init (base 0x00020500)
000205b7
50058593
// Set UART baud rate: 50MHz / 115200 = 434
1b200513
00c5a623
// Enable UART TX/RX
00300513
0085a423
// Send 'S' (System Start) - wait for TX ready
05300513
0045a703
00277713
fe070ee3
00a5a023
// Protection init (base 0x00020200)
000202b7
20028293
// Clear all latched faults first (write 0xF to FAULT_CLEAR)
00f00513
0082a423
// Disable watchdog in fault enable (0x07 = OCP+OVP+ESTOP only)
00700513
0042a223
// Kick watchdog immediately
deadc537
00a2a823
// Set watchdog timeout to very long (0x2FAF080 = 50M cycles = 1 second)
02faf537
08050513
00a2a623
// Send 'P' (Protection OK)
05000513
0045a703
00277713
fe070ee3
00a5a023
// PWM init (base 0x00020000)
00020337
00000513
00a32023
00100513
00a32223
05200513
00a32523
03200513
00a32723
80008537
00a32423
// Send 'W' (PWM configured)
05700513
0045a703
00277713
fe070ee3
00a5a023
// Enable PWM
00300513
00a32023
// Send 'R' (Running)
05200513
0045a703
00277713
fe070ee3
00a5a023
// GPIO init (base 0x00020400)
00020e37
400e0e13
00f00513
008e2423
00100513
00ae2023
// Main loop - load constants
deadc537
00000e93
// Loop: KICK WATCHDOG FIRST (before checking faults!)
00a2a823
// Now check faults
0002a703
00071a63
// ADC read (base 0x00020100)
00020fb7
100f8f93
00100513
00afa023
004fa703
00177713
fe071ee3
008fa503
// Toggle LED
000e2703
00476713
00ee2023
// Delay
01000f13
ffff0f13
fe0f1ee3
001e8e93
f5dff06f
// Fault handler - clear fault and restart PWM instead of hanging!
00f00513
0082a423
// Kick watchdog
deadc537
00a2a823
// Re-enable PWM
00300513
00a32023
// Send 'R' (Recovered)
05200513
0045a703
00277713
fe070ee3
00a5a023
// Return to main loop
f1dff06f
00000013
00000013
0000006f
